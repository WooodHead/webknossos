@()

<tr class="<%if(annotations.state.isFinished){print('finished')}else{print('unfinished')}%>">
  <td> <%= tasks.formattedHash %> </td>
  <td> <%= (tasks.type.summary || "<deleted>") + " - " + annotations.typ %></td>
  <td> <%= tasks.projectName %> </td>
  <td> <%= tasks.type.description || "" %></td>
  <td>
    <span class="label"> <%= tasks.type.settings.allowedModes %></span>
  </td>
  <td class="nowrap">
    <% if (annotations.state.isFinished) { %>
      <i class="icon-ok"></i><span> Finished</span><br />
        <% if (annotations.review.comments && annotations.review.comments.length > 0) { %>
          <br />
          <a href="#" rel="popover" data-placement="bottom" data-title="Comment from Reviewer" data-html="true"
             data-content="<%= annotations.review.comments[0].replace(/\n/g, '<br /><br />')%>)">
              <i class="icon-eye-open"></i> Review successful<span class="caret-down"></span>
          </a>
        <% } %>
    <% } else if (annotations.state.isInReview || annotations.state.isReadyForReview) { %>
      <i class="icon-eye-open"></i><span> In Review</span>
    <% } else { %>
      <a href="<%= jsRoutes.controllers.AnnotationController.trace(annotations.typ, annotations.id).url %>"><i class="icon-random"></i> trace</a><br/>
      <a href="<%= jsRoutes.controllers.AnnotationController.finish(annotations.typ, annotations.id).url %>" class="trace-finish" data-ajax="replace-row,confirm=@Messages("annotation.finish.confirm")" ><i class="icon-ok-circle"></i> finish</a>

      <% if (annotations.review.comments && annotations.review.comments.length > 0) { %>
        <br />
        <a href="#" rel="popover" data-placement="bottom" data-title="Comment from Reviewer" data-html="true"
           data-content="<%= annotations.review.comments[0].replace(/\n/g, '<br /><br />')%>)">
            <i class="icon-eye-open"></i> Review failed<span class="caret-down"></span>
        </a>
      <% } %>
    <% } %>
  </td>
</tr>